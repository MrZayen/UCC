<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>United Cultural Club</title>
  <link rel="stylesheet" href="style.css">
  <style type="text/css" media="all">
    body {
      margin: 0;
      padding: 0;
      font-family: Sans-Serif;
    }
    .activity_main {
      width: 100%;
      height: 100vh;
      overflow: scroll;
    }
    .activity_main header {
      width: 100%;
      max-width: 600px;
      height: 100px;
      background-color: #fff;
      margin: 0 auto;
      position: sticky;
      top: -50px;
      user-select: none;
    }
    .activity_main .top-bar {
      width: 100%;
      height: 50px;
      position: relative;
    }
    .activity_main .top-bar__icon {
      width: 35px;
      height: 35px;
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
    }
    .activity_main .tab-bar {
      width: 100%;
      height: 50px;
      display: flex;
    }
    .activity_main .tab-bar__btn {
      flex: 1;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .activity_main .tab-bar__btn-title {
      height: 100%;
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .activity_main .tab-bar__btn-title span {
      font-size: 15px;
      font-weight: 420;
    }
    .activity_main .tab-bar__btn.active .tab-bar__btn-title::after {
      content: "";
      width: 100%;
      height: 4px;
      border-radius: 100px;
      background-color: #000;
      position: absolute;
      bottom: 0;
    }
    .activity_main .tab-bar__btn.active .tab-bar__btn-title span {}

    .activity_main main {
      width: 100%;
      max-width: 600px;
      margin: 0 auto;
    }
    .activity_main .container {
      width: 100%;
    }
    .activity_main .container .fragment {
      width: 100%;
      display: none;
    }
    .activity_main .container .fragment.show {
      display: block;
    }
    .activity_main .container .fragment--collections {
      height: 200vh;
      background-color: red;
    }
    .activity_main .container .fragment--expanses {
      height: 200vh;
      background-color: green;
    }
  </style>
</head>
<body>
  <div class="activity_main">
    <header>
      <div class="top-bar">
        <div class="top-bar__icon top-bar__btn">
          <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 24 24" style="enable-background:new 0 0 24 24;" xml:space="preserve">
            <path d="M17.523,15.342c-0.552,0-1-0.447-1-0.999s0.447-1,0.999-1c0.552,0,1,0.447,1,0.999  C18.522,14.894,18.075,15.341,17.523,15.342 M6.477,15.342c-0.552,0-1-0.447-1-0.999c0-0.552,0.447-1,0.999-1  c0.552,0,1,0.447,1,0.999C7.476,14.894,7.029,15.341,6.477,15.342 M17.881,9.322l1.997-3.459c0.115-0.199,0.047-0.453-0.152-0.568  c-0.199-0.115-0.453-0.047-0.568,0.152l0,0l-2.022,3.503C15.59,8.244,13.853,7.851,12,7.851S8.41,8.244,6.863,8.949L4.841,5.447  C4.726,5.248,4.472,5.18,4.273,5.294C4.075,5.409,4.006,5.663,4.121,5.862l0,0l1.997,3.46c-3.43,1.865-5.775,5.337-6.119,9.44h24  C23.656,14.659,21.311,11.187,17.881,9.322" />
          </svg>
        </div>
      </div>
      <div class="tab-bar">
        <div class="tab-bar__btn active">
          <div class="tab-bar__btn-title">
            <span>Collections</span>
          </div>
        </div>
        <div class="tab-bar__btn">
          <div class="tab-bar__btn-title">
            <span>Expanses</span>
          </div>
        </div>
      </div>
    </header>
    <main>
      <div class="container">
        <div class="fragment fragment--collections show">

        </div>
        <div class="fragment fragment--expanses">

        </div>
      </div>
    </main>
  </div>



  <script type="text/javascript" charset="utf-8">

    let activityMain = document.querySelectorAll(".activity_main")[0];
    let topBarBtn = document.querySelectorAll(".top-bar__btn");
    let tabBarBtn = document.querySelectorAll(".tab-bar__btn");
    let tabFragment = document.querySelectorAll(".fragment");

    let activeTabBtn = sessionStorage.getItem("activeTabBtn");
    if (activeTabBtn === null) {
      sessionStorage.setItem("activeTabBtn", "collectionsTabBtn");
      sessionStorage.setItem("collectionsScrollTop", 0);
    }

    topBarBtn.forEach((btn)=> {
      btn.addEventListener("click", ()=> {
        sessionStorage.clear();
        location.reload();
      })
    });

    tabBarBtn.forEach((btn, index)=> {
      btn.addEventListener("click", ()=> {
        if (!btn.classList.contains("active")) {
          tabBarBtn.forEach((btn)=> {
            btn.classList.remove("active");
          });
          btn.classList.add("active");
          tabFragment.forEach((fragment)=> {
            fragment.classList.remove("show");
          });
          tabFragment[index].classList.add("show");

          /*Test Code*/
          switch (index) {
            case 0:
              let collectionsScrollTop = sessionStorage.getItem("collectionsScrollTop");
              if (collectionsScrollTop === null) {
                sessionStorage.setItem("collectionsScrollTop", 0);
              }
              sessionStorage.setItem("activeTabBtn", "collectionsTabBtn");
              restoreState();
              break;
            case 1:
              let expansesScrollTop = sessionStorage.getItem("expansesScrollTop");
              if (expansesScrollTop === null) {
                sessionStorage.setItem("expansesScrollTop", 0);
              }
              sessionStorage.setItem("activeTabBtn", "expansesTabBtn");
              restoreState();
              break;
          };

        } else {};
      });
    });

    activityMain.addEventListener("scroll", (e)=> {
      let activeTabBtn = sessionStorage.getItem("activeTabBtn");
      if (activeTabBtn === "collectionsTabBtn") {
        sessionStorage.setItem("collectionsScrollTop", e.target.scrollTop);
      } else if (activeTabBtn === "expansesTabBtn") {
        sessionStorage.setItem("expansesScrollTop", e.target.scrollTop);
      };
    });
    restoreState(true);

    function restoreState(isFirstTime) {
      let activeTabBtn = sessionStorage.getItem("activeTabBtn");
      let collectionsScrollTop = sessionStorage.getItem("collectionsScrollTop");
      let expansesScrollTop = sessionStorage.getItem("expansesScrollTop");

      if (activeTabBtn === "collectionsTabBtn") {
        if (isFirstTime) {
          tabBarBtn[0].click();
        }
        activityMain.scrollTop = collectionsScrollTop;
      } else if (activeTabBtn === "expansesTabBtn") {
        if (isFirstTime) {
          tabBarBtn[1].click();
        }
        activityMain.scrollTop = expansesScrollTop;
      }
    }
  </script>
</body>
</html>